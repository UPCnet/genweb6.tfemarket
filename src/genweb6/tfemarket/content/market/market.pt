<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="ca"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="genweb6.tfemarket">

<body>

<metal:content-core fill-slot="content-core">

<metal:block define-macro="content-core">

  <div id="mercatTFE">

    <tal:comment replace="nothing">
      <<< ALERTAS >>>
    </tal:comment>

    <div class="alert alert-danger alert-mercat alert-dismissible fade show" role="alert"
         tal:condition="view/showErrorConfiguration">

      <i class="bi bi-exclamation-triangle-fill me-2"></i>
      <strong>Error</strong>
      <span i18n:translate="">SOA bus or Digital Identity not configured. Contact the site administrator.</span>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>

    </div>

    <div class="alert alert-danger alert-mercat alert-dismissible fade show" role="alert"
         tal:condition="view/showErrorNotConfigured">

      <i class="bi bi-exclamation-triangle-fill me-2"></i>
      <strong>Error</strong>
      <span i18n:translate="">Falta carregar les titulacions.</span>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>

    </div>

    <tal:comment replace="nothing">
      <<< IDIOMAS >>>
    </tal:comment>

    <div class="w-100 text-end mb-3">
      <button type="button" class="btn btn-outline-secondary me-2 setLangCA">
          <span>Català</span>
      </button>
      <button type="button" class="btn btn-outline-secondary me-2 setLangES">
          <span>Español</span>
      </button>
      <button type="button" class="btn btn-outline-secondary setLangEN">
          <span>English</span>
      </button>
    </div>

    <tal:comment replace="nothing">
      <<< SOLICITUDES DEL ESTUDIANTE >>>
    </tal:comment>

    <div id="userApplication"
         tal:define="userApplications view/userApplications"
         tal:condition="userApplications">

      <h2 i18n:translate="">Your application</h2>

      <div class="table-responsive">

        <table class="table table-borderless border-bottom">

          <thead class="table-secondary">

            <tr>

              <th scope="col" i18n:translate="">Degree</th>
              <th scope="col" i18n:translate="">Identifier Offer TFE</th>
              <th scope="col"></th>

            </tr>

          </thead>

          <tbody>

            <tr tal:repeat="app userApplications">

              <td tal:content="app/degree_title">Degree</td>

              <td>
                <a tal:content="python:app['offer_id'] + ' ' + app['offer_title']"
                   tal:attributes="href python:context.absolute_url() +'?searchOffer&offer=' + app['offer_id']">Identifier Offer TFE</a>
              </td>

              <td class="d-flex justify-content-end">

                <tal:comment replace="nothing">
                  <<< CAMBIO DE ESTADO >>>
                </tal:comment>

                <button class="btn btn-outline-secondary disabled me-2" type="button"
                        i18n:domain="genweb6.tfemarket.workflow"
                        tal:condition="not:app/workflows"
                        tal:content="app/state">
                  State
                </button>

                <div class="dropdown me-2"
                     tal:condition="app/workflows">

                  <button class="btn btn-outline-secondary dropdown-toggle"
                          type="button" data-bs-toggle="dropdown" aria-expanded="false"
                          i18n:domain="genweb6.tfemarket.workflow"
                          tal:content="app/state">
                    State
                  </button>

                  <ul class="dropdown-menu">

                    <li tal:repeat="estat app/workflows">

                      <a class="dropdown-item"
                         tal:attributes="href string:${context/absolute_url}/changeActualState?estat=${estat/id}&id=${app/item_path}&${view/filtersString}">

                        <span i18n:domain="genweb6.tfemarket.workflow"
                              tal:content="estat/title">
                          Estat
                        </span>

                      </a>

                    </li>

                  </ul>

                </div>

                <tal:comment replace="nothing">
                  <<< EDITAR >>>
                </tal:comment>

                <a class="btn btn-outline-secondary me-2"
                   i18n:attributes="alt edit"
                   tal:attributes="href string:${app/url}/edit"
                   tal:condition="app/can_edit">

                  <i class="bi bi-pencil"></i>
                </a>

                <tal:comment replace="nothing">
                  <<< INFORMACIÓN >>>
                </tal:comment>

                <a class="btn btn-outline-info" data-bs-toggle="modal"
                   tal:attributes="data-bs-target string:#modal${app/UID}">

                  <i class="bi bi-info-circle"></i>
                </a>

                <div class="modal fade" tabindex="-1" aria-hidden="true"
                     tal:attributes="id string:modal${app/UID};
                                     aria-labelledby string:modal${app/UID}Label">

                  <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                      <div class="modal-header">

                        <h1 class="modal-title fs-5"
                            tal:attributes="id string:modal${app/UID}Label"
                            i18n:translate="">Description</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

                      </div>
                      <div class="modal-body">

                        <p class="offerID mb-1">
                          <span class="fw-bold"><span i18n:translate="">Offer id</span>: </span>
                          <span tal:content="app/offer_id"></span>
                        </p>
                        <p class="offerTitle mb-3">
                          <span class="fw-bold"><span i18n:translate="">Offer title</span>: </span>
                          <span tal:content="app/offer_title"></span>
                        </p>
                        <p class="fullname mb-1">
                          <span class="fw-bold"><span i18n:translate="">Fullname</span>: </span>
                          <span tal:content="app/title"></span>
                        </p>
                        <p class="dni mb-1">
                          <span class="fw-bold"><span i18n:translate="">DNI</span>: </span>
                          <span tal:content="app/dni"></span>
                        </p>
                        <p class="email mb-1">
                          <span class="fw-bold"><span i18n:translate="">Email</span>: </span>
                          <a tal:content="app/email"
                                tal:attributes="href string:mailto:${app/email}"></a>
                        </p>
                        <p class="telephone mb-3">
                          <span class="fw-bold"><span i18n:translate="">Telephone</span>: </span>
                          <span tal:content="app/phone"></span>
                        </p>
                        <div class="description">
                          <p class="fw-bold mb-1"><span i18n:translate="">Body</span>: </p>
                          <p tal:content="app/body"></p>
                        </div>

                      </div>
                      <div class="modal-footer">

                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                                i18n:translate="">Close</button>

                      </div>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <tal:block tal:define="ccc view/classCollapseCercador">

      <tal:comment replace="nothing">
        <<< CREACIÓN OFERTAS Y COLLAPSE BUSCADOR >>>
      </tal:comment>

      <div class="d-inline-block w-100 text-end my-3"
           condition="view/checkPermissionCreateOffers">

        <a class="btn btn-primary me-2"
           tal:condition="view/checkPermissionCreateOffers"
           tal:attributes="href string:${context/absolute_url}/++add++genweb.tfemarket.offer">
          <span i18n:translate="">Create an offer</span>
        </a>

        <a class="btn btn-outline-secondary collapseBtn" data-bs-toggle="collapse" href="#collapseCercador"
           role="button" aria-expanded="true" aria-controls="collapseCercador"
           tal:attributes="class string:btn btn-outline-secondary collapseBtn ${ccc/btn};
                           aria-expanded ccc/aria">

          <span class="collapseShow" i18n:translate="">Show search</span>
          <span class="collapseHide" i18n:translate="">Hide search</span>
        </a>

      </div>

      <tal:comment replace="nothing">
        <<< BUSCADOR >>>
      </tal:comment>

      <div class="mb-4 collapse show" id="collapseCercador"
           tal:attributes="class string:mb-4 ${ccc/cercador};"
           tal:define="save view/saveFilters;
                       keys save/keys">

        <div class="card card-body border-0">

          <h2 class="mt-2 mb-4" i18n:translate="">Quines ofertes cerques?</h2>

          <form id="formSearchOffers" name="searchOffers" action="?search" method="post"
                class="position-relative"
                tal:attributes="data-saved python: 0 if 'language' in keys else 1">

            <div class="spinner-mercat position-absolute top-50 start-50 translate-middle d-none">
              <div class="spinner-border text-primary" role="status">
                <span class="sr-only">Loading...</span>
              </div>
            </div>

            <div class="mb-3">
              <label for="title" class="form-label" i18n:translate="">Text to search</label>
              <input name="title" class="form-control" type="text" id="searchTitle"
                     tal:attributes="value save/title|nothing" />
            </div>

            <div class="mb-3 row g-3">
              <div class="col-md-9">
                <label for="degree" class="form-label" i18n:translate="">Degree</label>
                <select name="degree" class="form-select" id="searchDegree">
                  <tal:block tal:repeat="degree view/getDegrees">
                    <tal:block tal:define="selected python:'degree' in keys and not save['degree'] == 'a' and degree['id'] == save['degree']">
                      <option tal:attributes="value degree/id;
                                              selected python:True if selected else False"
                              tal:content="degree/lit">Degree</option>
                    </tal:block>
                  </tal:block>
                </select>
              </div>
              <div class="col-md-3">
                <label for="topic" class="form-label" i18n:translate="">Topic</label>
                <select name="topic" class="form-select" id="searchTopic">
                  <option value="a" i18n:translate="">MAll</option>
                  <tal:block tal:repeat="topic view/getTopics">
                    <tal:block tal:define="selected python:'topic' in keys and not save['topic'] == 'a' and topic == save['topic']">
                      <option tal:attributes="value topic;
                                              selected python: True if selected else False"
                              tal:content="topic">Topic</option>
                    </tal:block>
                  </tal:block>
                </select>
              </div>
            </div>

            <div class="mb-3 row g-3">
              <div class="col-md-6">
                <label for="teacher" class="form-label" i18n:translate="">TFEteacher</label>
                <select name="teacher" class="form-select" id="searchTeacher">
                  <option value="a" i18n:translate="">MAll</option>
                  <tal:block tal:repeat="teacher view/getTeachers">
                    <tal:block tal:define="selected python:'teacher' in keys and not save['teacher'] == 'a' and teacher['id'] == save['teacher']">
                      <option tal:attributes="value teacher/id;
                                              selected python:True if selected else False"
                              tal:content="teacher/lit">Teacher</option>
                    </tal:block>
                  </tal:block>
                </select>
              </div>
              <div class="col-md-3">
                <label for="departament" class="form-label" i18n:translate="">TFEdepartament</label>
                <select name="departament" class="form-select" id="searchDepartament">
                  <option value="a" i18n:translate="">MAll</option>
                  <tal:block tal:repeat="departament view/getDepartaments">
                    <tal:block tal:define="selected python:'departament' in keys and not save['departament'] == 'a' and departament == save['departament']">
                      <option tal:attributes="value departament;
                                              selected python:True if selected else False"
                              tal:content="departament">Departament</option>
                    </tal:block>
                  </tal:block>
                </select>
              </div>
              <div class="col-md-3">
                <label for="type" class="form-label" i18n:translate="">Type</label>
                <select name="type" class="form-select" id="searchType">
                  <tal:block tal:repeat="type view/getTypes">
                    <tal:block tal:define="selected python:'type' in keys and not save['type'] == 'a' and type['id'] == save['type']">
                      <option tal:attributes="value type/id;
                                              selected python:True if selected else False"
                              tal:content="type/lit">Type</option>
                    </tal:block>
                  </tal:block>
                </select>
              </div>
            </div>

            <div class="mb-3 row g-3">
              <div class="col-md-6">
                <label for="company" class="form-label" i18n:translate="">Company</label>
                <select name="company" class="form-select" id="searchCompany">
                  <option value="a" i18n:translate="">All</option>
                  <tal:block tal:repeat="company view/getCompanys">
                    <tal:block tal:define="selected python:'company' in keys and not save['company'] == 'a' and company == save['company']">
                      <option tal:attributes="value company;
                                              selected python:True if selected else False"
                              tal:content="company">Company</option>
                    </tal:block>
                  </tal:block>
                </select>
              </div>
              <div class="col-md-3">
                <label for="date" class="form-label" i18n:translate="">Date</label>
                <select name="date" class="form-select" id="searchDate">
                  <tal:block tal:repeat="date view/getDates">
                    <tal:block tal:define="selected python:'date' in keys and not save['date'] == 'a' and date['id'] == save['date']">
                      <option tal:attributes="value date/id;
                                              selected python:True if selected else False"
                              tal:content="date/lit">Date</option>
                    </tal:block>
                  </tal:block>
                </select>
              </div>
              <div class="col-md-3">
                <label for="state" class="form-label" i18n:translate="">State</label>
                <select name="state" class="form-select" id="searchState">
                  <option value="a" i18n:translate="">MAll</option>
                  <tal:block tal:repeat="state view/getStates">
                    <tal:block tal:define="selected python:'state' in keys and not save['state'] == 'a' and state['id'] == save['state']">
                      <option tal:attributes="value state/id;
                                              selected python:True if selected else False"
                              tal:content="state/lit">State</option>
                    </tal:block>
                  </tal:block>
                </select>
              </div>
            </div>

            <div class="mb-3 row g-3">
              <div class="col-md-6" id="searchLanguage">
                <label for="language" class="form-label d-block" i18n:translate="">Developer language</label>
                <tal:block tal:repeat="lang view/getLanguages">
                  <div class="form-check form-check-inline"
                       tal:define="selected python:'language' in keys and view.flattenedString(lang) in save['language']">

                    <input name="language" class="form-check-input" type="checkbox"
                           tal:attributes="value lang;
                                           checked python:True if selected else False">
                    <label for="language" class="form-check-label" i18n:translate=""
                           tal:content="lang">Language</label>
                  </div>
                </tal:block>
              </div>
              <div class="col-md-3">
                <label for="grant" class="form-label" i18n:translate="">grant</label>
                <div class="form-check form-switch">
                  <input name="grant" class="form-check-input" type="checkbox"
                         id="searchGrant" role="switch" id="flexSwitchCheckDefault"
                         tal:attributes="checked python:True if 'grant' in keys else False">
                </div>
              </div>
            </div>

            <div class="mb-3 row g-3" id="searchKeys" tal:condition="view/getKeys">
              <label for="keys" class="form-label" i18n:translate="">Keywords</label>
              <div class="mt-0">
                <tal:block tal:repeat="key view/getKeys">
                  <tal:block tal:define="selected python:'key' in keys and view.flattenedString(key) in save['key']">

                    <input name="key" class="btn-check" type="checkbox" autocomplete="off"
                           tal:attributes="value key;
                                           id key;
                                           checked python:True if selected else False">
                    <label class="btn btn-outline-secondary btn-sm rounded-pill bg-light px-3 me-1 mb-2"
                           tal:attributes="for key"
                           tal:content="key">Key</label>

                  </tal:block>
                </tal:block>
              </div>
            </div>

            <div class="d-inline-block w-100 text-end buscador-mercat">

              <tal:comment replace="nothing">
                <<< ACCIONES >>>
              </tal:comment>

              <button class="btn btn-primary me-2" type="submit">
                <i class="bi bi-search me-1"></i>
                <span i18n:translate="">Search</span>
              </button>

              <a class="btn btn-outline-secondary bg-light me-2"
                 tal:attributes="href string:${context/absolute_url}?allOffers">
                <span i18n:translate="">View all offers</span>
              </a>

              <a class="btn btn-outline-secondary bg-light"
                 tal:condition="view/currentUserIsAloneTeacher"
                 tal:attributes="href context/absolute_url">
                <span i18n:translate="">View me offers</span>
              </a>

            </div>

          </form>

        </div>
      </div>
    </tal:block>

    <tal:comment replace="nothing">
      <<< OFERTAS >>>
    </tal:comment>

    <tal:ofertes tal:define="offers view/getOffers">

      <div class="alert alert-primary alert-mercat d-flex align-items-center d-inline-block" role="alert"
           tal:condition="not:offers">

        <i class="bi bi-info-circle-fill me-2"></i>
        <div i18n:translate="">No results found.</div>
      </div>

      <tal:llista tal:condition="offers">

        <div class="d-inline-block w-100 text-end mb-3"
             tal:condition="False">

          <a id="collapseAll" class="btn btn-outline-secondary collapseBtn collapsed" data-bs-toggle="collapse"
             role="button" aria-expanded="false" aria-controls="collapseAll">

            <span class="collapseShow" i18n:translate="">Desplega tot</span>
            <span class="collapseHide" i18n:translate="">Plega tot</span>
          </a>

        </div>

        <div class="accordion" id="accordionOfertes">

          <div class="accordion-item" tal:repeat="offer offers">

            <h2 class="accordion-header"
                tal:attributes="id string:heading-${offer/offer_id}">


              <button class="accordion-button collapsed" type="button"
                      data-bs-toggle="collapse" aria-expanded="false"
                      tal:attributes="data-bs-target string:#collapse-${offer/offer_id};
                                      aria-controls string:collapse-${offer/offer_id}">

                <p class="w-100 mb-0 me-3 collapsed"
                   tal:content="offer/title">Item Title</p>

                <div class="w-75 me-3">

                  <p class="mb-0">

                    <strong><tal:omit-tag i18n:translate="">Teacher manager</tal:omit-tag>: </strong>
                    <tal:omit-tag tal:content="offer/teacher_fullname">Aureli Condogvia</tal:omit-tag>

                  </p>

                  <p class="mb-0"
                     tal:condition="offer/codirector">

                    <strong><tal:omit-tag i18n:translate="">Codirector</tal:omit-tag>: </strong>
                    <tal:omit-tag tal:content="offer/codirector">Codirector</tal:omit-tag>

                  </p>

                </div>

                <div class="badges col-md-2 d-flex justify-content-end me-2">

                  <span class="me-2 badge text-bg-secondary"
                        tal:repeat="tfgm offer/tfgm"
                        tal:content="tfgm">TFG</span>

                  <span class="me-2 badge text-bg-primary"
                        i18n:domain="genweb6.tfemarket.workflow"
                        tal:content="offer/state">State</span>

                  <span class="me-2 badge text-bg-danger"
                        tal:condition="offer/is_expired"
                        i18n:translate="">expired</span>

                </div>

              </button>

            </h2>

            <div class="collapseOfertes accordion-collapse collapse" data-bs-parent="#accordionOfertes"
                 tal:define="applications python:view.getApplications(offer)"
                 tal:attributes="aria-labelledby string:heading-${offer/offer_id};
                                 id string:collapse-${offer/offer_id}">

              <div class="accordion-body">

                <tal:comment replace="nothing">
                  <<< ACCIONES OFERTA >>>
                </tal:comment>

                <div class="d-flex flex-row-reverse w-100">

                  <tal:comment replace="nothing">
                    <<< SOLICITAR >>>
                  </tal:comment>

                 <a class="btn btn-primary ms-2"
                     tal:condition="offer/can_create_application"
                     tal:attributes="href string:${context/absolute_url}/requestOffer?id=${offer/item_path}&offer=${offer/offer_id}${view/getActualView}&open=Y">
                    <span i18n:translate="">Request the offer</span>
                  </a>

                  <tal:comment replace="nothing">
                    <<< EDITAR >>>
                  </tal:comment>

                  <a class="btn btn-outline-secondary ms-2"
                     i18n:attributes="alt edit"
                     tal:attributes="href string:${offer/url}/edit"
                     tal:condition="offer/can_edit">

                    <i class="bi bi-pencil"></i>
                  </a>

                  <tal:comment replace="nothing">
                    <<< CAMBIO DE ESTADO >>>
                  </tal:comment>

                  <div class="dropdown"
                       tal:condition="offer/workflows">

                    <button class="btn btn-outline-secondary dropdown-toggle"
                            type="button" data-bs-toggle="dropdown" aria-expanded="false"
                            i18n:domain="genweb6.tfemarket.workflow"
                            tal:content="offer/state">
                      State
                    </button>

                    <ul class="dropdown-menu">

                      <li tal:repeat="estat offer/workflows">

                        <a class="dropdown-item"
                           tal:attributes="href string:${context/absolute_url}/changeActualState?estat=${estat/id}&id=${offer/item_path}&offer=${offer/offer_id}${view/getActualView}">

                          <span i18n:domain="genweb6.tfemarket.workflow"
                                tal:content="estat/title">
                            Estat
                          </span>

                        </a>

                      </li>

                    </ul>

                  </div>

                </div>

                <tal:comment replace="nothing">
                  <<< NOTIFICACIONES >>>
                </tal:comment>

                <div tal:attributes="id string:${offer/offer_id}-info" class="offerInfo mt-4"></div>

                <tal:block tal:condition="applications">
                  <div class="alert alert-info alert-mercat alert-dismissible fade show" role="alert"
                       tal:condition="offer/assign_offer">

                    <i class="bi bi-info-circle-fill me-2"></i>
                    <strong>Info</strong>
                    <span i18n:translate="">The current offer contains a confirmed application.</span>

                    <a class="btn btn-success" i18n:translate=""
                       tal:attributes="href string:${context/absolute_url}/changeActualState?estat=${offer/assign_offer}&id=${offer/item_path}&offer=${offer/offer_id}${view/getActualView}">
                      Assign the offer
                    </a>

                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                  </div>
                </tal:block>

                <tal:comment replace="nothing">
                  <<< INFORMACIÓN OFERTA >>>
                </tal:comment>

                <div class="row">

                  <div class="col-md-6">

                    <div class="mb-3">

                      <p class="mb-1">
                        <strong><tal:omit-tag i18n:translate="">Teacher manager</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:content="offer/teacher_fullname">Aureli Condogvia</tal:omit-tag>
                      </p>

                      <p class="mb-1">
                        <strong><tal:omit-tag i18n:translate="">Teacher Email</tal:omit-tag>: </strong>
                        <a tal:content="offer/teacher_email"
                           tal:attributes="href string:mailto:${offer/teacher_email}">???@???.???</a>
                      </p>

                      <p class="mb-1">
                        <strong><tal:omit-tag i18n:translate="">Departament</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:content="offer/dept">Departament</tal:omit-tag>
                      </p>

                    </div>

                    <div class="mb-3">

                      <p class="mb-1" tal:condition="offer/codirector">
                        <strong><tal:omit-tag i18n:translate="">Codirector</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:content="offer/codirector">Aureli Condogvia</tal:omit-tag>
                      </p>

                      <p class="mb-1" tal:condition="offer/codirector_email">
                        <strong><tal:omit-tag i18n:translate="">Codirector Email</tal:omit-tag>: </strong>
                        <a tal:content="offer/codirector_email"
                           tal:attributes="href string:mailto:${offer/codirector_email}">???@???.???</a>
                      </p>

                      <p class="mb-1" tal:condition="offer/codirector_dept">
                        <strong><tal:omit-tag i18n:translate="">Departament</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:content="offer/codirector_dept">Departament</tal:omit-tag>
                      </p>

                    </div>

                    <div class="mb-3">

                      <strong><tal:omit-tag i18n:translate="">Degrees</tal:omit-tag>: </strong>
                      <ul>
                        <li tal:repeat="degree offer/degrees"
                            tal:content="python:view.getDegreeLiteralFromId(degree)">Degree</li>
                      </ul>

                    </div>


                  </div>

                  <div class="col-md-6">

                    <div class="mb-3">

                      <p class="mb-1">
                        <strong><tal:omit-tag i18n:translate="">Offer id</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:content="offer/offer_id">Identificador</tal:omit-tag>
                      </p>

                    </div>

                    <div class="mb-3">

                      <p class="mb-1">
                        <strong><tal:omit-tag i18n:translate="">Modality</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:content="offer/modality">Modalitat</tal:omit-tag>
                      </p>

                      <tal:block tal:condition="offer/if_modality_company">
                        <p class="mb-1">
                          <strong><tal:omit-tag i18n:translate="">Company</tal:omit-tag>: </strong>
                          <tal:omit-tag tal:content="offer/company">Company</tal:omit-tag>
                        </p>
                      </tal:block>

                      <p class="mb-1">
                        <strong><tal:omit-tag i18n:translate="">Possibility of scholarship</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:condition="offer/grant"
                                      i18n:translate="">Yes</tal:omit-tag>
                        <tal:omit-tag tal:condition="not: offer/grant"
                                      i18n:translate="">No</tal:omit-tag>
                      </p>

                    </div>

                    <div class="mb-3">

                      <p class="mb-1" tal:condition="not: offer/multiple_langs">
                        <strong><tal:omit-tag i18n:translate="">Language work elaboration</tal:omit-tag>: </strong>
                        <tal:block tal:repeat="lang offer/langs">
                          <tal:omit-tag i18n:translate=""
                                        tal:content="lang">Language</tal:omit-tag>
                        </tal:block>
                      </p>

                      <div class="language" tal:condition="offer/multiple_langs">
                        <strong><tal:omit-tag i18n:translate="">Languages work elaboration</tal:omit-tag>: </strong>
                        <ul>
                          <li tal:repeat="lang offer/langs"
                              i18n:translate=""
                              tal:content="lang">Language</li>
                        </ul>
                      </div>

                    </div>

                    <div class="mb-3"
                         tal:condition="offer/keywords">

                      <p class="mb-1">
                        <strong><tal:omit-tag i18n:translate="">Keywords</tal:omit-tag>: </strong>
                      </p>
                      <span class="badge text-bg-secondary px-3 py-2 me-1 mb-2"
                            tal:repeat="keyword offer/keywords"
                            tal:content="keyword">Keyword</span>

                    </div>

                  </div>

                  <div class="col-md-12">

                    <div class="mb-3" tal:condition="offer/description">
                      <p class="mb-0"><strong><tal:omit-tag i18n:translate="">Description<tal:omit-tag>: </strong></p>
                      <p class="mb-0" tal:content="offer/description">Nam fermentum tellus vel tellus imperdiet.</p>
                    </div>

                    <div class="mb-3" tal:condition="offer/targets">
                      <p class="mb-0"><strong><tal:omit-tag i18n:translate="">Targets<tal:omit-tag>: </strong></p>
                      <p class="mb-0" tal:content="offer/targets"></p>
                    </div>

                    <div class="mb-3" tal:condition="offer/features">
                      <p class="mb-0"><strong><tal:omit-tag i18n:translate="">Features<tal:omit-tag>: </strong></p>
                      <p class="mb-0" tal:content="offer/features"></p>
                    </div>

                    <div class="mb-3">

                      <p class="mb-1" tal:condition="offer/topic">
                        <strong><tal:omit-tag i18n:translate="">Topic</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:content="offer/topic">Topic</tal:omit-tag>
                      </p>

                      <p class="mb-1" tal:condition="offer/offer_type">
                        <strong><tal:omit-tag i18n:translate="">Type</tal:omit-tag>: </strong>
                        <tal:omit-tag i18n:translate="" tal:content="offer/offer_type">Type</tal:omit-tag>
                      </p>

                      <p class="mb-1" tal:condition="view/showNumEstudiants">
                        <strong><tal:omit-tag i18n:translate="">Number of students</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:content="offer/num_students">1</tal:omit-tag>
                      </p>

                    </div>

                    <div class="mb-3" tal:condition="offer/workload">
                      <p class="mb-0"><strong><tal:omit-tag i18n:translate="">Workload<tal:omit-tag>: </strong></p>
                      <p class="mb-0" tal:content="offer/workload">Workload</p>
                    </div>

                    <div class="mb-3" tal:condition="offer/requirements">
                      <p class="mb-0"><strong><tal:omit-tag i18n:translate="">Requirements<tal:omit-tag>: </strong></p>
                      <p class="mb-0" tal:content="offer/requirements"></p>
                    </div>

                    <div class="mb-3">

                      <p class="mb-1">
                        <strong><tal:omit-tag i18n:translate="">Environmental theme</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:condition="offer/environmental_theme" i18n:translate="">Yes</tal:omit-tag>
                        <tal:omit-tag tal:condition="not: offer/environmental_theme" i18n:translate="">No</tal:omit-tag>
                      </p>

                      <p class="mb-1">
                        <strong><tal:omit-tag i18n:translate="">Confidential</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:condition="offer/confidential" i18n:translate="">Yes</tal:omit-tag>
                        <tal:omit-tag tal:condition="not: offer/confidential" i18n:translate="">No</tal:omit-tag>
                      </p>

                      <p class="mb-1">
                        <strong><tal:omit-tag i18n:translate="">Scope of cooperation</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:condition="offer/scope_cooperation" i18n:translate="">Yes</tal:omit-tag>
                        <tal:omit-tag tal:condition="not: offer/scope_cooperation" i18n:translate="">No</tal:omit-tag>
                      </p>

                    </div>

                    <div class="mb-3">

                      <p class="mb-1" tal:condition="offer/effective_date">
                        <strong><tal:omit-tag i18n:translate="">Publication date</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:content="offer/effective_date">expirationDate</tal:omit-tag>
                      </p>

                      <p class="mb-1" tal:condition="offer/expiration_date">
                        <strong><tal:omit-tag i18n:translate="">Expiration date</tal:omit-tag>: </strong>
                        <tal:omit-tag tal:content="offer/expiration_date">2018/04/29</tal:omit-tag>
                      </p>

                    </div>

                  </div>

                </div>

              <tal:comment replace="nothing">
                <<< SOLICITUDES >>>
              </tal:comment>

              <tal:block tal:condition="python:view.openApplicationsTav() and applications">

                <div class="table-responsive">

                  <table class="table table-borderless border-bottom"
                         tal:condition="applications">

                    <thead class="table-secondary">

                      <tr>

                        <th scope="col" i18n:translate="">DNI</th>
                        <th scope="col" i18n:translate="">Name</th>
                        <th scope="col" i18n:translate="">Email</th>
                        <th scope="col" i18n:translate="">Mobile</th>
                        <th scope="col" i18n:translate="">Degree</th>
                        <th scope="col" i18n:translate="">Identifier Offer TFE</th>
                        <th scope="col"></th>

                      </tr>

                    </thead>

                    <tbody>

                      <tr tal:repeat="app applications">

                        <td tal:content="app/dni">DNI</td>

                        <td tal:content="app/name">Name</td>

                        <td>
                          <a tal:content="app/email"
                             tal:attributes="href string:mailto:${app/email}">Email</a>
                        </td>

                        <td tal:content="app/phone">Mobile</td>

                        <td tal:content="app/degree_title">Degree</td>

                        <td tal:content="python:app['offer_id'] + ' ' + app['offer_title']">ID</td>

                        <td class="d-flex justify-content-end">

                          <tal:comment replace="nothing">
                            <<< CAMBIO DE ESTADO >>>
                          </tal:comment>

                          <button class="btn btn-outline-secondary disabled me-2" type="button"
                                  i18n:domain="genweb6.tfemarket.workflow"
                                  tal:condition="not:app/workflows"
                                  tal:content="app/state">
                            State
                          </button>

                          <div class="dropdown me-2"
                               tal:condition="app/workflows">

                            <button class="btn btn-outline-secondary dropdown-toggle"
                                    type="button" data-bs-toggle="dropdown" aria-expanded="false"
                                    i18n:domain="genweb6.tfemarket.workflow"
                                    tal:content="app/state">
                              State
                            </button>

                            <ul class="dropdown-menu">

                              <li tal:repeat="estat app/workflows">

                                <a class="dropdown-item"
                                   tal:attributes="href string:${context/absolute_url}/changeActualState?estat=${estat/id}&id=${app/item_path}&${view/filtersString}">

                                  <span i18n:domain="genweb6.tfemarket.workflow"
                                        tal:content="estat/title">
                                    Estat
                                  </span>

                                </a>

                              </li>

                            </ul>

                          </div>

                          <tal:comment replace="nothing">
                            <<< EDITAR >>>
                          </tal:comment>

                          <a class="btn btn-outline-secondary me-2"
                             i18n:attributes="alt edit"
                             tal:attributes="href string:${app/url}/edit"
                             tal:condition="app/can_edit">

                            <i class="bi bi-pencil"></i>
                          </a>

                          <tal:comment replace="nothing">
                            <<< INFORMACIÓN >>>
                          </tal:comment>

                          <a class="btn btn-outline-info" data-bs-toggle="modal"
                             tal:attributes="data-bs-target string:#modal${app/UID}">

                            <i class="bi bi-info-circle"></i>
                          </a>

                          <div class="modal fade" tabindex="-1" aria-hidden="true"
                               tal:attributes="id string:modal${app/UID};
                                               aria-labelledby string:modal${app/UID}Label">

                            <div class="modal-dialog modal-lg">
                              <div class="modal-content">
                                <div class="modal-header">

                                  <h1 class="modal-title fs-5"
                                      tal:attributes="id string:modal${app/UID}Label"
                                      i18n:translate="">Description</h1>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

                                </div>
                                <div class="modal-body">

                                  <p class="offerID mb-1">
                                    <span class="fw-bold"><span i18n:translate="">Offer id</span>: </span>
                                    <span tal:content="app/offer_id"></span>
                                  </p>
                                  <p class="offerTitle mb-3">
                                    <span class="fw-bold"><span i18n:translate="">Offer title</span>: </span>
                                    <span tal:content="app/offer_title"></span>
                                  </p>
                                  <p class="fullname mb-1">
                                    <span class="fw-bold"><span i18n:translate="">Fullname</span>: </span>
                                    <span tal:content="app/title"></span>
                                  </p>
                                  <p class="dni mb-1">
                                    <span class="fw-bold"><span i18n:translate="">DNI</span>: </span>
                                    <span tal:content="app/dni"></span>
                                  </p>
                                  <p class="email mb-1">
                                    <span class="fw-bold"><span i18n:translate="">Email</span>: </span>
                                    <a tal:content="app/email"
                                          tal:attributes="href string:mailto:${app/email}"></a>
                                  </p>
                                  <p class="telephone mb-3">
                                    <span class="fw-bold"><span i18n:translate="">Telephone</span>: </span>
                                    <span tal:content="app/phone"></span>
                                  </p>
                                  <div class="description">
                                    <p class="fw-bold mb-1"><span i18n:translate="">Body</span>: </p>
                                    <p tal:content="app/body"></p>
                                  </div>

                                </div>
                                <div class="modal-footer">

                                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                                          i18n:translate="">Close</button>

                                </div>
                              </div>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </tal:block>

              <tal:comment replace="nothing">
                <<< SOLICITAR >>>
              </tal:comment>

             <a class="btn btn-primary"
                 tal:condition="offer/can_create_application"
                 tal:attributes="href string:${context/absolute_url}/requestOffer?id=${offer/item_path}&offer=${offer/offer_id}${view/getActualView}&open=Y">
                <span i18n:translate="">Request the offer</span>
              </a>

            </div>

          </div>

        </div>

      </tal:llista>

    </tal:ofertes>

  </div>

  <script type="text/javascript"
          tal:attributes="src string:${context/absolute_url}/++theme++genweb6.tfemarket/js/market.min.js">
  </script>

</metal:content-core>
</body>
</html>
